# 实验配置对比

本文档提供了5种不同的超参数配置，用于比较不同设置对MaskDM性能的影响。

## CIFAR-10 数据集信息
- **训练集**: 50,000张图像
- **测试集**: 10,000张图像
- **图像尺寸**: 32x32 RGB

## 配置概览

| 配置 | 用途 | 数据集大小 | 批次大小 | 学习率 | Logits | 训练轮数 | 最大步数 |
|------|------|-----------|----------|--------|--------|----------|----------|
| Config 1 | 快速调试 | 5,000 | 16 | 0.5 | 3.0 | 1,000 | 5,000 |
| Config 2 | 平衡实验 | 20,000 | 64 | 1.0 | 5.0 | 2,000 | 15,000 |
| Config 3 | 追求最佳 | 50,000 | 32 | 2.0 | 7.0 | 3,000 | 25,000 |
| Config 4 | GPU优化 | 25,000 | 128 | 1.5 | 6.0 | 1,500 | 12,000 |
| Config 5 | 精细调优 | 30,000 | 32 | 0.8 | 10.0 | 4,000 | 30,000 |

## 详细配置说明

### Configuration 1: 快速验证配置
**目标**: 快速迭代和调试
- **数据集**: 5,000张图像 (10% CIFAR-10)
- **批次大小**: 16 (内存友好)
- **学习率**: 0.5 (保守)
- **训练时间**: 最短
- **适用场景**: 代码调试、快速验证想法

### Configuration 2: 标准平衡配置
**目标**: 效果与效率的平衡
- **数据集**: 20,000张图像 (40% CIFAR-10)
- **批次大小**: 64 (GPU利用率较好)
- **学习率**: 1.0 (标准)
- **训练时间**: 中等
- **适用场景**: 初步实验、参数搜索

### Configuration 3: 最佳性能配置
**目标**: 追求最佳实验效果
- **数据集**: 50,000张图像 (完整CIFAR-10)
- **批次大小**: 32 (经典设置)
- **学习率**: 2.0 (激进)
- **训练时间**: 最长
- **适用场景**: 最终实验、论文结果

### Configuration 4: GPU优化配置
**目标**: 充分利用GPU资源
- **数据集**: 25,000张图像 (50% CIFAR-10)
- **批次大小**: 128 (大批次)
- **学习率**: 1.5 (适中偏高)
- **训练时间**: 中等
- **适用场景**: 高端GPU、批次敏感性测试

### Configuration 5: 精细调优配置
**目标**: 精细优化和高质量mask
- **数据集**: 30,000张图像 (60% CIFAR-10)
- **批次大小**: 32 (稳定)
- **学习率**: 0.8 (精细)
- **Logits**: 10.0 (高倍数)
- **适用场景**: 最终调优、高质量结果

## 使用步骤

### 1. 生成基线损失
```bash
# 选择对应配置运行
bash scripts/loss/loss_config1.sh
bash scripts/loss/loss_config2.sh
# ... 其他配置
```

### 2. 训练MaskDM
```bash
# 确保先运行了对应的loss配置
bash scripts/train/train_config1.sh
bash scripts/train/train_config2.sh
# ... 其他配置
```

### 3. 评估结果
```bash
# 评估训练好的模型
bash scripts/test/test_config1.sh
bash scripts/test/test_config2.sh
# ... 其他配置
```

## 推荐实验顺序

1. **Config 1**: 首先验证代码正确性
2. **Config 2**: 进行初步超参数探索
3. **Config 4**: 测试GPU效率和大批次效果
4. **Config 3**: 运行完整数据集实验
5. **Config 5**: 精细调优获得最佳结果

## 预期结果对比

- **训练速度**: Config 1 > Config 4 > Config 2 > Config 5 > Config 3
- **内存使用**: Config 4 > Config 2 > Config 3,5 > Config 1
- **预期质量**: Config 5 > Config 3 > Config 2 > Config 4 > Config 1
- **稳定性**: Config 1,5 > Config 2 > Config 4 > Config 3

## 注意事项

1. **依赖关系**: 训练脚本依赖对应的损失文件，确保先运行loss脚本
2. **GPU内存**: Config 4需要更多GPU内存，如果OOM请减小批次大小
3. **存储空间**: Config 3和5会产生更多中间文件
4. **收敛性**: 高学习率配置可能需要更多监控
